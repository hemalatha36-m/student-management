[import json
import os

DATA_FILE = "data.json"

# Load students from JSON file
def load_data():
    if os.path.exists(DATA_FILE):
        with open(DATA_FILE, "r") as f:
            return json.load(f)
    return []

# Save students to JSON file
def save_data(students):
    with open(DATA_FILE, "w") as f:
        json.dump(students, f, indent=4)

# Add Student
def add_student(students):
    roll = input("Roll no: ").strip()
    if any(s['roll_no'] == roll for s in students):
        print("❌ Roll no already exists.")
        return students
    
    name = input("Name: ").strip()
    grade = input("Grade: ").strip()
    age = input("Age: ").strip()

    students.append({
        "roll_no": roll,
        "name": name,
        "grade": grade,
        "age": age
    })
    save_data(students)
    print("✅ Student added successfully.")
    return students

# View Students
def view_students(students):
    if not students:
        print("⚠️ No students found.")
        return
    print("\n--- Student List ---")
    for s in students:
        print(f"Roll: {s['roll_no']} | Name: {s['name']} | Grade: {s['grade']} | Age: {s['age']}")

# Search Student
def search_student(students):
    roll = input("Enter roll no to search: ").strip()
    for s in students:
        if s['roll_no'] == roll:
            print(f"✅ Found: {s}")
            return
    print("❌ Student not found.")

# Update Student
def update_student(students):
    roll = input("Enter roll no to update: ").strip()
    for s in students:
        if s['roll_no'] == roll:
            print(f"Current data: {s}")
            s['name'] = input("New Name: ").strip() or s['name']
            s['grade'] = input("New Grade: ").strip() or s['grade']
            s['age'] = input("New Age: ").strip() or s['age']
            save_data(students)
            print("✅ Student updated.")
            return students
    print("❌ Student not found.")
    return students

# Delete Student
def delete_student(students):
    roll = input("Enter roll no to delete: ").strip()
    new_list = [s for s in students if s['roll_no'] != roll]
    if len(new_list) != len(students):
        save_data(new_list)
        print("✅ Student deleted.")
    else:
        print("❌ Student not found.")
    return new_list

# Main Menu
def main():
    students = load_data()
    while True:
        print("\n=== Student Management System ===")
        print("1) Add  2) View  3) Search  4) Update  5) Delete  6) Exit")
        choice = input("Choice: ").strip()

        if choice == "1":
            students = add_student(students)
        elif choice == "2":
            view_students(students)
        elif choice == "3":
            search_student(students)
        elif choice == "4":
            students = update_student(students)
        elif choice == "5":
            students = delete_student(students)
        elif choice == "6":
            print("👋 Goodbye!")
            break
        else:
            print("❌ Invalid choice.")

if __name__ == "__main__":
    main()]
